"0","library(rootSolve)"
"2","package ‘rootSolve’ was built under R version 4.0.3"
"0","b <- rep(1/N, N)"
"0",""
"0","# function definition F(x) = Sigma %*% x - b/x"
"0","f_root <- function(x, parms) {"
"0","  Sigma <- parms"
"0","  N <- nrow(Sigma)"
"0","  return(Sigma %*% x - b/x)"
"0","}"
"0",""
"0","# finding the root"
"0","x_root <- multiroot(f_root, start = b, parms = Sigma)$root"
"0","w_root <- x_root/sum(x_root)"
"0",""
"0","w_all <- cbind(w_all, "
"0","               ""RPP (root)"" = w_root)"
"0","# compute risk contributions"
"0","risk_all <- cbind(risk_all, "
"0","                  ""RPP (root)"" = as.vector(w_root * (Sigma %*% w_root)))"
"0","RRC_all <- sweep(risk_all, MARGIN = 2, STATS = colSums(risk_all), FUN = ""/"")  # normalize each column"
"0","# plot"
"0","barplot(t(RRC_all), col = rainbow8equal[1:5],"
"0","        main = ""Relative risk contribution"", xlab = ""stocks"", ylab = ""risk"", beside = TRUE, legend = colnames(RRC_all))"
