"0","portfolioCDaR <- function(X, c = 0.1, alpha = 0.95) {"
"0","  T <- nrow(X)"
"0","  N <- ncol(X)"
"0","  X <- as.matrix(X)"
"0","  X_cum <- apply(X, MARGIN = 2, FUN = cumsum)"
"0","  mu <- colMeans(X)"
"0","  # variables"
"0","  w <- Variable(N)"
"0","  z <- Variable(T)"
"0","  zeta <- Variable(1)"
"0","  u <- Variable(T)"
"0","  # problem"
"0","  prob <- Problem(Maximize(t(w) %*% mu),"
"0","                  constraints = list(w >= 0, sum(w) == 1,"
"0","                                     zeta + (1/(T*(1-alpha))) * sum(z) <= c,"
"0","                                     z >= 0, z >= u - X_cum %*% w - zeta,"
"0","                                     u >= X_cum %*% w,"
"0","                                     u[-1] >= u[-T]))"
"0","  result <- solve(prob)"
"0","  return(as.vector(result$getValue(w)))"
"0","}"
"0",""
"0","# FIXME"
"0","w_CDaR095_c014 <- portfolioCDaR(X_log_trn, c = 0.14, alpha = 0.95)"
"0","w_CDaR095_c016 <- portfolioCDaR(X_log_trn, c = 0.16, alpha = 0.95)"
"0","w_CDaR099_c017 <- portfolioCDaR(X_log_trn, c = 0.17, alpha = 0.99)"
"0","w_CDaR099_c019 <- portfolioCDaR(X_log_trn, c = 0.19, alpha = 0.99)"
"0",""
"0","# combine portfolios"
"0","w_all <- cbind(w_all, "
"0","               ""CDaR095-c-014"" = w_CDaR095_c014, "
"0","               ""CDaR095-c-016"" = w_CDaR095_c016, "
"0","               ""CDaR099-c-017"" = w_CDaR099_c017, "
"0","               ""CDaR099-c-019"" = w_CDaR099_c019)"
"0",""
"0","# compute returns of all portfolios"
"0","ret_all <- xts(X_lin %*% w_all, index(X_lin))"
"0","ret_all_trn <- ret_all[1:T_trn, ]"
"0","ret_all_tst <- ret_all[-c(1:T_trn), ]"
"0",""
"0","# performance"
"0","t(table.AnnualizedReturns(ret_all_tst)[3, ])"
"1","               "
"1"," Annualized Sharpe (Rf=0%)"
"1","
GMVP           "
"1","                    0.8331"
"1","
Markowitz      "
"1","                    3.3546"
"1","
DR-alpha-3     "
"1","                    0.6611"
"1","
CVaR-alpha-0.99"
"1","                    1.4844"
"1","
Max-DD-c-021   "
"1","                    0.9763"
"1","
Ave-DD-c-004   "
"1","                    0.7577"
"1","
CDaR095-c-014  "
"1","                    0.9438"
"1","
CDaR095-c-016  "
"1","                    0.8328"
"1","
CDaR099-c-017  "
"1","                    0.9851"
"1","
CDaR099-c-019  "
"1","                    0.9355"
"1","
"
"0","t(maxDrawdown(ret_all_tst))"
"1","               "
"1"," Worst Drawdown"
"1","
GMVP           "
"1","      0.1618798"
"1","
Markowitz      "
"1","      0.2924094"
"1","
DR-alpha-3     "
"1","      0.1761356"
"1","
CVaR-alpha-0.99"
"1","      0.1396687"
"1","
Max-DD-c-021   "
"1","      0.1580033"
"1","
Ave-DD-c-004   "
"1","      0.1774612"
"1","
CDaR095-c-014  "
"1","      0.1625203"
"1","
CDaR095-c-016  "
"1","      0.1719010"
"1","
CDaR099-c-017  "
"1","      0.1546998"
"1","
CDaR099-c-019  "
"1","      0.1633803"
"1","
"
"0","t(AverageDrawdown(ret_all_tst))"
"1","               "
"1"," Average Drawdown"
"1","
GMVP           "
"1","       0.02412443"
"1","
Markowitz      "
"1","       0.05260494"
"1","
DR-alpha-3     "
"1","       0.02524018"
"1","
CVaR-alpha-0.99"
"1","       0.01909016"
"1","
Max-DD-c-021   "
"1","       0.03006926"
"1","
Ave-DD-c-004   "
"1","       0.04892681"
"1","
CDaR095-c-014  "
"1","       0.03583177"
"1","
CDaR095-c-016  "
"1","       0.04215747"
"1","
CDaR099-c-017  "
"1","       0.02268762"
"1","
CDaR099-c-019  "
"1","       0.03383564"
"1","
"
"0","t(CDD(ret_all_trn))"
"1","               "
"1"," Conditional Drawdown 5%"
"1","
GMVP           "
"1","              0.06626555"
"1","
Markowitz      "
"1","              0.19151542"
"1","
DR-alpha-3     "
"1","              0.07137488"
"1","
CVaR-alpha-0.99"
"1","              0.06565987"
"1","
Max-DD-c-021   "
"1","              0.06885930"
"1","
Ave-DD-c-004   "
"1","              0.09463311"
"1","
CDaR095-c-014  "
"1","              0.06892476"
"1","
CDaR095-c-016  "
"1","              0.07966771"
"1","
CDaR099-c-017  "
"1","              0.06613209"
"1","
CDaR099-c-019  "
"1","              0.06828860"
"1","
"
"0","t(CDD(ret_all_tst))"
"1","               "
"1"," Conditional Drawdown 5%"
"1","
GMVP           "
"1","              0.06166899"
"1","
Markowitz      "
"1","              0.09725709"
"1","
DR-alpha-3     "
"1","              0.04296381"
"1","
CVaR-alpha-0.99"
"1","              0.05167597"
"1","
Max-DD-c-021   "
"1","              0.08649004"
"1","
Ave-DD-c-004   "
"1","              0.12860938"
"1","
CDaR095-c-014  "
"1","              0.09780699"
"1","
CDaR095-c-016  "
"1","              0.11536860"
"1","
CDaR099-c-017  "
"1","              0.07797121"
"1","
CDaR099-c-019  "
"1","              0.09600039"
"1","
"
"0","{ chart.CumReturns(ret_all, main = ""Cumulative return of portfolios"", "
"0","                   wealth.index = TRUE, legend.loc = ""topleft"", colorset = rich10equal)"
"0","  addEventLines(xts(""training"", index(X_lin[T_trn])), srt=90, pos=2, lwd = 2, col = ""darkblue"") }"
