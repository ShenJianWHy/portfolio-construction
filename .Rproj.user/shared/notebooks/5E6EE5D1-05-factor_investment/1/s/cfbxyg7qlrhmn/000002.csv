"0","K <- 3"
"0","alpha <- colMeans(X)"
"0","X_ <- X - matrix(alpha, T, N, byrow = TRUE)"
"0","Sigma_prev <- matrix(0, N, N)"
"0","Sigma <- (1/(T-1)) * t(X_) %*% X_"
"0","eigSigma <- eigen(Sigma)"
"0","while (norm(Sigma - Sigma_prev, ""F"")/norm(Sigma, ""F"") > 1e-3) {"
"0","  B <- eigSigma$vectors[, 1:K, drop = FALSE] %*% diag(sqrt(eigSigma$values[1:K]), K, K)"
"0","  Psi <- diag(diag(Sigma - B %*% t(B)))"
"0","  Sigma_prev <- Sigma"
"0","  Sigma <- B %*% t(B) + Psi"
"0","  eigSigma <- eigen(Sigma - Psi)"
"0","}"
"0","cbind(alpha, B)"
"1","    "
"1","         alpha"
"1","            "
"1","             "
"1","              "
"1","
AAPL"
"1","  1.518806e-03"
"1"," 0.004423866"
"1"," -0.013661448"
"1"," -1.788346e-05"
"1","
AMD "
"1","  2.091040e-03"
"1"," 0.009061167"
"1"," -0.027857022"
"1","  2.320626e-02"
"1","
ADI "
"1","  5.884322e-04"
"1"," 0.005641178"
"1"," -0.015542966"
"1"," -1.490695e-03"
"1","
ABBV"
"1","  5.472661e-04"
"1"," 0.003349058"
"1"," -0.008726896"
"1"," -6.934982e-04"
"1","
AEZS"
"1"," -2.417018e-03"
"1"," 0.071585588"
"1","  0.011675066"
"1","  6.196286e-04"
"1","
A   "
"1","  8.495955e-04"
"1"," 0.003759136"
"1"," -0.010820120"
"1"," -1.278586e-03"
"1","
APD "
"1","  8.611818e-04"
"1"," 0.003264547"
"1"," -0.010724091"
"1"," -2.846693e-03"
"1","
AA  "
"1"," -9.611000e-04"
"1"," 0.009394316"
"1"," -0.023328796"
"1"," -1.770902e-02"
"1","
CF  "
"1","  5.801694e-05"
"1"," 0.006801149"
"1"," -0.016344844"
"1"," -9.315729e-03"
"1","
"
