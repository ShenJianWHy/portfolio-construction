"0",""
"0","T <- nrow(X_lin)"
"0","T_trn <- round(0.5*T)"
"0","X_log_trn <- X_log[1:T_trn, ]"
"0","X_log_tst <- X_log[(T_trn+1):T, ]"
"0","X_lin_trn <- X_lin[1:T_trn, ]"
"0","X_lin_tst <- X_lin[(T_trn+1):T, ]"
"0","mu <- colMeans(X_log_trn)"
"0","Sigma <- cov(X_log_trn)"
"0",""
"0",""
"0","# create empty portfolio matrix"
"0","w_MVP_rolling <- X_log"
"0","w_MVP_rolling[] <- NA"
"0","rebal_indices <- T_trn + endpoints(X_log_tst, on = ""months"")"
"0",""
"0","# run the rolling window loop"
"0","lookback <- 10*20  # maximum value is: floor(T_trn/20)*20"
"0","for (i in 1:length(rebal_indices)) {"
"0","  # estimate moments"
"0","  X_ <- X_log[(rebal_indices[i] - lookback + 1):rebal_indices[i], ]"
"0","  mu <- colMeans(X_)"
"0","  Sigma <- cov(X_)"
"0","  # design portfolio"
"0","  w_MVP_rolling[rebal_indices[i], ] <- MVP(mu, Sigma, lmd = 2, long_only = TRUE)"
"0","}"
"0","w_MVP_rolling <- na.omit(w_MVP_rolling)"
"0",""
"0","# compute portfolio returns"
"0","tmp <- Return.portfolio(X_lin_tst, weights = w_MVP_rolling, verbose = TRUE)"
"0","ret_rolling <- tmp$returns"
"0","chart.StackedBar(tmp$BOP.Weight, main = ""Evolution of rolling-window Markowitz's mean-variance portfolio"","
"0","                 ylab = ""w"", space = 0, border = NA)"
"0",""
