"0","F_ <- cbind(ones = 1, f)"
"0","Gamma <- t(X) %*% F_ %*% solve(t(F_) %*% F_)  # better: Gamma <- t(solve(t(F_) %*% F_, t(F_) %*% X))"
"0","colnames(Gamma) <- c(""alpha"", ""beta"")"
"0","alpha <- Gamma[, ""alpha""]"
"0","beta <- Gamma[, ""beta""]"
"0","print(Gamma)"
"1","    "
"1","         alpha"
"1","      beta"
"1","
AAPL"
"1","  1.027794e-03"
"1"," 1.1840884"
"1","
AMD "
"1","  1.491217e-03"
"1"," 1.4464899"
"1","
ADI "
"1","  7.909772e-05"
"1"," 1.2282732"
"1","
ABBV"
"1","  2.062470e-04"
"1"," 0.8223764"
"1","
AEZS"
"1"," -2.820424e-03"
"1"," 0.9728238"
"1","
A   "
"1","  4.486762e-04"
"1"," 0.9668272"
"1","
APD "
"1","  4.474286e-04"
"1"," 0.9977766"
"1","
AA  "
"1"," -1.587258e-03"
"1"," 1.5099957"
"1","
CF  "
"1"," -4.558246e-04"
"1"," 1.2391421"
"1","
"
"0","E <- xts(t(t(X) - Gamma %*% t(F_)), index(X))  # residuals"
"0","Psi <- (1/(T-2)) * t(E) %*% E"
"0","Sigma <- as.numeric(var(f)) * beta %o% beta + diag(diag(Psi))"
